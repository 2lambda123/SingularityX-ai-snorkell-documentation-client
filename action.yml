name: 'Snorkell DocGen Client'
description: 'Use this GitHub Action to create documentation PR of your recent main branch merge.'
author: 'snorkell.ai'

outputs: {}

runs:
  using: 'composite'

  steps:
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.x

    - name: Install Dependencies
      shell: bash
      run: |
        pip install aiohttp asyncio
        ESCAPED_COMMIT_MSG=$(printf '%s\n' "${{ github.event.head_commit.message }}" | jq -R -s -c .)

    - name: Run Script
      shell: bash
      env:
        SNORKELL_CLIENT_ID: ${{ secrets.SNORKELL_CLIENT_ID }}
        SNORKELL_API_KEY: ${{ secrets.SNORKELL_API_KEY }}
        GITHUB_REPOSITORY: ${{ github.repository }}
        BRANCH_NAME: ${{ github.ref }}
        GITHUB_SHA: ${{ github.sha }}
        COMMIT_MSG: ${{ ESCAPED_COMMIT_MSG }}

      run: |
        python src/index.py
         
branding:
  icon: 'upload-cloud'
  color: 'blue'
